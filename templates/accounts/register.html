{% extends "base.html" %} {% load translate %} {% block title %}{% trans
'register' %}{% endblock %} {% block content %}
<section class="auth">
  <div class="card auth-card">
    <h2 class="card-title">{% trans 'register' %}</h2>
    <form method="post" class="form">
      {% csrf_token %} {% if form.non_field_errors %}
      <div class="alert error">{{ form.non_field_errors }}</div>
      {% endif %}

      <div class="form-group">
        <label for="id_username">{% trans 'username' %}</label>
        {{ form.username }} {% if form.username.errors %}<small
          class="field-error"
          >{{ form.username.errors|striptags }}</small
        >{% endif %}
      </div>

      <div class="form-group">
        <label for="id_email">{% trans 'email' %}</label>
        {{ form.email }} {% if form.email.errors %}<small class="field-error"
          >{{ form.email.errors|striptags }}</small
        >{% endif %}
      </div>

      <div class="form-group">
        <label for="id_password1">{% trans 'password' %}</label>
        <div class="password-field">
          {{ form.password1 }}
          <button
            type="button"
            class="btn-text toggle-password"
            aria-label="Show/Hide"
            data-target="id_password1"
          >
            üëÅÔ∏è
          </button>
        </div>
        {% if form.password1.errors %}<small class="field-error"
          >{{ form.password1.errors|striptags }}</small
        >{% endif %}
      </div>
      <div class="form-group">
        <label for="id_password2">{% trans 'confirm_password' %}</label>
        <div class="password-field">
          {{ form.password2 }}
          <button
            type="button"
            class="btn-text toggle-password"
            aria-label="Show/Hide"
            data-target="id_password2"
          >
            üëÅÔ∏è
          </button>
        </div>
        {% if form.password2.errors %}<small class="field-error"
          >{{ form.password2.errors|striptags }}</small
        >{% endif %}
      </div>

      <div
        class="form-group"
        style="
          margin-top: 20px;
          padding: 15px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          border-radius: 8px;
        "
      >
        <label
          style="
            display: flex;
            align-items: center;
            color: white;
            cursor: pointer;
          "
        >
          {{ form.activate_premium }}
          <span style="margin-left: 10px; font-weight: 500"
            >üëë Activate Premium License</span
          >
        </label>
      </div>

      <div class="form-group" id="license-code-field" style="display: none">
        <label for="id_license_code">License Code</label>
        {{ form.license_code }}
        <small style="color: #666; font-size: 12px"
          >Enter your premium license activation code (e.g.,
          PREMIUM-XXXX)</small
        >
        {% if form.license_code.errors %}<small class="field-error"
          >{{ form.license_code.errors|striptags }}</small
        >{% endif %}
      </div>

      <button class="btn btn-primary btn-block" type="submit">
        {% trans 'register' %}
      </button>
    </form>
    <p class="muted">
      {% trans 'have_account' %}
      <a href="{% url 'login' %}">{% trans 'login' %}</a>
    </p>
  </div>
</section>

<script>
  document.addEventListener("click", function (e) {
    const btn = e.target.closest(".toggle-password");
    if (!btn) return;
    const id = btn.getAttribute("data-target");
    const input = document.getElementById(id);
    if (!input) return;
    input.type = input.type === "password" ? "text" : "password";
  });

  // Toggle license code field based on checkbox
  const activatePremiumCheckbox = document.getElementById(
    "id_activate_premium"
  );
  const licenseCodeField = document.getElementById("license-code-field");

  if (activatePremiumCheckbox) {
    activatePremiumCheckbox.addEventListener("change", function () {
      if (this.checked) {
        licenseCodeField.style.display = "block";
      } else {
        licenseCodeField.style.display = "none";
      }
    });

    // Show field if checkbox is already checked (e.g., form validation errors)
    if (activatePremiumCheckbox.checked) {
      licenseCodeField.style.display = "block";
    }
  }
</script>
{% endblock %}
